# 终端 Chatbot 项目需求分析与设计

## 1. 核心愿景

创建一个功能强大、交互丰富的终端聊天机器人应用 (TUI - Text-based User Interface)。应用将通过 `npx` 启动，提供模块化的功能和持久化的数据管理。

## 2. 核心功能需求

### 2.1. 整体布局 (TUI)

- **双栏结构:**
    - **左侧边栏 (Sidebar):**
        - **主导航区:** 用于在不同功能模块间切换。
            - `Chat` (聊天)
            - `Agent` (智能体 - 预留)
            - `知识库` (预留)
            - `系统设置`
        - **上下文区:** 在 `Chat` 视图下，此区域显示历史聊天会话列表，支持快速切换。
    - **右侧主区域 (Main Content):**
        - **标题栏:** 显示当前活动会话的标题。
        - **聊天窗口:** 可滚动的区域，展示完整的对话历史。
        - **输入框:** 底部用于用户输入。

### 2.2. 功能模块

- **聊天 (Chat):**
    - 核心的多轮对话功能。
    - 支持流式响应，提供即时反馈。
- **会话管理 (Session Management):**
    - **新建会话:** (`Ctrl+N`) 创建一个新的、独���的聊天。
    - **切换会话:** 在左侧边栏列表中选择并加载不同的历史会话。
    - **持久化:** 所有会话都将被自动保存，并在下次启动时加载。
- **系统设置 (System Settings):**
    - 提供 UI 界面来配置：
        - API Keys
        - 默认模型
        - 模型参数 (temperature, etc.)
- **Agent & 知识库:**
    - 作为未来扩展的预留功能模块。

### 2.3. 启动与配置

- **`npx` 启动:** 无需本地安装，通过 `npx chatbot-tui` 即可运行。
- **命令行参数:** 支持通过命令行参数进行额外设置 (例如指定模型启动)。

## 3. 技术选型

- **运行时:** Node.js
- **包管理器:** pnpm
- **语言:** TypeScript
- **CLI 框架:** `@stricli/core` (通过 `npx @stricli/create-app@latest` 初始化)
- **TUI 库:** `blessed`
- **配置管理:** `conf`
- **API 请求:** `axios` 或 `node-fetch`

## 4. 迭代计划

### 第一迭代：TUI 基础框架与核心聊天
- **目标:** 搭建起左右分栏的 TUI 布局，并实现最核心的聊天功能。
- **任务:**
    1.  使用 `@stricli/create-app` 初始化项目。
    2.  集成 `blessed` 库。
    3.  构建静态的 TUI 布局 (左右分栏，标题/聊天/输入框)。
    4.  实现基础的输入提交和流式响应显示。

### 第二迭代：交互性与会话管理
- **目标:** 让界面“活起来”，实现视图切换和聊天历史管理。
- **任务:**
    1.  实现侧边栏主导航的切换逻辑。
    2.  在侧边栏实现可交互的聊天历史列表。
    3.  实现新建会话 (`Ctrl+N`) 和切换会话的功能。
    4.  在内存中管理多个会话状态。

### 第三迭代：数据持久化与高级功能
- **目标:** 实现配置和聊天记录的保存，并完成“系统设置”等高级功能。
- **任务:**
    1.  实现“系统设置”视图，并集成 `conf` 进行配置管理。
    2.  实现聊天会话的本地文件持久化。
    3.  完成 `npx` 发布准备 (`bin` 字段, `build` 脚本)。
    4.  编写 `README.md`。
